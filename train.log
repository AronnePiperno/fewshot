[2025-01-11 16:57:13,476][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 16:57:13,478][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 16:57:13,503][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 16:57:13,506][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
          ^^^^^^^^^^^^^^^^^^
AttributeError: module 'src.data' has no attribute 'custom_datamodule'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
          ^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/def/fewshot/src/data/custom_datamodule.py", line 5, in <module>
    from src.data.components.dataset import T3ALDataset
  File "/home/def/fewshot/src/data/components/dataset.py", line 2, in <module>
    import pandas as pd
ModuleNotFoundError: No module named 'pandas'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
             ^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.data.custom_datamodule.T3ALDataModule':
ModuleNotFoundError("No module named 'pandas'")
Are you sure that 'custom_datamodule' is importable from module 'src.data'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 54, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.data.custom_datamodule.T3ALDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2025-01-11 16:57:13,508][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_16-57-13
[2025-01-11 16:57:47,829][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 16:57:47,831][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 16:57:47,852][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 16:57:48,204][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 16:57:48,647][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
          ^^^^^^^^^^^^^^^^^^
AttributeError: module 'src.models' has no attribute 'tt_method_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
          ^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/def/fewshot/src/models/tt_method_module.py", line 8, in <module>
    from src.evaluate import evaluate
  File "/home/def/fewshot/src/evaluate.py", line 8, in <module>
    from tabulate import tabulate
ModuleNotFoundError: No module named 'tabulate'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
             ^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.models.tt_method_module.T3ALModule':
ModuleNotFoundError("No module named 'tabulate'")
Are you sure that 'tt_method_module' is importable from module 'src.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.models.tt_method_module.T3ALModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2025-01-11 16:57:48,649][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_16-57-47
[2025-01-11 16:58:37,384][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 16:58:37,386][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 16:58:37,409][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 16:58:37,667][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 16:58:38,421][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: T3ALNet.__init__() missing 1 required positional argument: 'avg_features_path'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
TypeError("T3ALNet.__init__() missing 1 required positional argument: 'avg_features_path'")
full_key: model.net
[2025-01-11 16:58:38,422][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_16-58-37
[2025-01-11 17:03:27,561][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 17:03:27,564][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 17:03:27,588][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 17:03:27,854][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 17:03:28,566][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: T3ALNet.__init__() missing 1 required positional argument: 'avg_features_path'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
TypeError("T3ALNet.__init__() missing 1 required positional argument: 'avg_features_path'")
full_key: model.net
[2025-01-11 17:03:28,567][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_17-03-27
[2025-01-11 17:10:43,684][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 17:10:43,687][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 17:10:43,717][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 17:10:44,187][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 17:10:45,127][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: T3ALNet.__init__() missing 1 required positional argument: 'avg_features_path'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
TypeError("T3ALNet.__init__() missing 1 required positional argument: 'avg_features_path'")
full_key: model.net
[2025-01-11 17:10:45,128][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_17-10-43
[2025-01-11 17:22:21,427][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 17:22:21,430][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 17:22:21,458][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 17:22:21,933][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 17:22:22,893][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 17:22:26,529][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 17:22:27,982][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 83, in __init__
    self.video_dir = os.path.join(self.video_path, "Thumos14/videos/")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen posixpath>", line 76, in join
TypeError: expected str, bytes or os.PathLike object, not NoneType

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
TypeError('expected str, bytes or os.PathLike object, not NoneType')
full_key: model.net
[2025-01-11 17:22:27,984][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_17-22-21
[2025-01-11 17:31:06,034][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 17:31:06,037][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 17:31:06,064][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 17:31:06,548][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 17:31:05,651][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 17:31:08,934][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 17:31:11,948][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 98, in __init__
    self.avg_features = self.load_avg_features(self.avg_features_path)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 123, in load_avg_features
    with open(path, "rb") as f:
         ^^^^^^^^^^^^^^^^
IsADirectoryError: [Errno 21] Is a directory: './data/Thumos14/support_videos_features/'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
IsADirectoryError(21, 'Is a directory')
full_key: model.net
[2025-01-11 17:31:11,963][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_17-31-05
[2025-01-11 17:56:27,798][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 17:56:27,801][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 17:56:27,831][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 17:56:28,326][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 17:56:29,296][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 17:56:33,225][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 17:56:36,392][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 103, in __init__
    importlib.import_module("config.zero_shot"), dict_test_name, None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/def/fewshot/config/zero_shot.py", line 25, in <module>
    with open('splits/train_75_test_25/ActivityNet/train/split_0.list', 'r') as filehandle:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'splits/train_75_test_25/ActivityNet/train/split_0.list'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
FileNotFoundError(2, 'No such file or directory')
full_key: model.net
[2025-01-11 17:56:36,396][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_17-56-27
[2025-01-11 17:57:44,182][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 17:57:44,185][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 17:57:44,210][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 17:57:44,459][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 17:57:45,187][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 17:57:48,484][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 17:57:50,606][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 103, in __init__
    importlib.import_module("config.zero_shot"), dict_test_name, None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/def/fewshot/config/zero_shot.py", line 25, in <module>
    with open('splits/train_75_test_25/ActivityNet/train/split_0.list', 'r') as filehandle:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'splits/train_75_test_25/ActivityNet/train/split_0.list'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
FileNotFoundError(2, 'No such file or directory')
full_key: model.net
[2025-01-11 17:57:50,609][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_17-57-44
[2025-01-11 17:59:41,599][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 17:59:41,602][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 17:59:41,626][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 17:59:41,866][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 17:59:42,620][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 17:59:46,230][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 17:59:50,204][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 103, in __init__
    importlib.import_module("config.zero_shot"), dict_test_name, None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1204, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1176, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1147, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 690, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/def/fewshot/config/zero_shot.py", line 25, in <module>
    with open('splits/train_75_test_25/ActivityNet/train/split_0.list', 'r') as filehandle:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'splits/train_75_test_25/ActivityNet/train/split_0.list'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
FileNotFoundError(2, 'No such file or directory')
full_key: model.net
[2025-01-11 17:59:50,206][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_17-59-41
[2025-01-11 18:01:34,188][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 18:01:34,190][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 18:01:34,213][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 18:01:34,482][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 18:01:35,166][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 18:01:38,860][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 18:01:42,636][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 110, in __init__
    with open(self.annotations_path, "r") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './data/thumos_annotations/thumos_anno_action.json'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
FileNotFoundError(2, 'No such file or directory')
full_key: model.net
[2025-01-11 18:01:42,638][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_18-01-34
[2025-01-11 18:04:34,509][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 18:04:34,512][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 18:04:34,535][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 18:04:34,775][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 18:04:35,490][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 18:04:39,226][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 18:04:41,465][__main__][INFO] - Instantiating callbacks...
[2025-01-11 18:04:41,466][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 18:04:41,469][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 18:04:41,469][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 18:04:41,469][__main__][INFO] - Instantiating loggers...
[2025-01-11 18:04:41,470][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 18:04:41,472][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 18:04:41,613][__main__][INFO] - Logging hyperparameters!
[2025-01-11 18:05:06,281][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 85, in train
    utils.log_hyperparameters(object_dict)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning_utilities/core/rank_zero.py", line 42, in wrapped_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/utils/logging_utils.py", line 51, in log_hyperparameters
    logger.log_hyperparams(hparams)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning_utilities/core/rank_zero.py", line 42, in wrapped_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loggers/wandb.py", line 429, in log_hyperparams
    self.experiment.config.update(params, allow_val_change=True)
    ^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/fabric/loggers/logger.py", line 118, in experiment
    return fn(self)
           ^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loggers/wandb.py", line 407, in experiment
    self._experiment = wandb.init(**self._wandb_init)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1303, in init
    wandb._sentry.reraise(e)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/wandb/analytics/sentry.py", line 156, in reraise
    raise exc.with_traceback(sys.exc_info()[2])
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 1289, in init
    return wi.init()
           ^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/wandb/sdk/wandb_init.py", line 821, in init
    result = run_init_handle.wait(
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/wandb/sdk/lib/mailbox.py", line 277, in wait
    raise MailboxError("transport failed")
wandb.sdk.lib.mailbox.MailboxError: transport failed
[2025-01-11 18:05:06,284][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_18-04-34
[2025-01-11 18:20:27,363][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 18:20:27,365][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 18:20:27,395][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 18:20:27,872][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 18:20:28,925][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 18:20:32,220][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 18:20:35,624][__main__][INFO] - Instantiating callbacks...
[2025-01-11 18:20:35,624][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 18:20:35,629][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 18:20:35,629][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 18:20:35,630][__main__][INFO] - Instantiating loggers...
[2025-01-11 18:20:35,630][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 18:20:35,633][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 18:20:35,752][__main__][INFO] - Logging hyperparameters!
[2025-01-11 18:20:35,758][__main__][INFO] - Starting training!
[2025-01-11 18:20:38,017][__main__][INFO] - Starting testing!
[2025-01-11 18:20:38,017][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 18:20:40,365][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 137, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
                                       ^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/fetchers.py", line 134, in __next__
    batch = super().__next__()
            ^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/fetchers.py", line 61, in __next__
    batch = next(self.iterator)
            ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/utilities/combined_loader.py", line 341, in __next__
    out = next(self._iterator)
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/utilities/combined_loader.py", line 142, in __next__
    out = next(self.iterators[0])
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1465, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1491, in _process_data
    data.reraise()
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/_utils.py", line 715, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 351, in _worker_loop
    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/home/def/fewshot/src/data/components/dataset.py", line 74, in __getitem__
    video_idx, video = self.baselinegetFeatureData(index)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/data/components/dataset.py", line 39, in baselinegetFeatureData
    video = self.loadFeature(video_idx)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/data/components/dataset.py", line 94, in loadFeature
    video_data = np.load(os.path.join(self.feature_path, idx + ".npy"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/numpy/lib/npyio.py", line 427, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './data/Thumos14/features/video_validation_0000365.npy'

[2025-01-11 18:20:40,381][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_18-20-27
[2025-01-11 18:20:40,381][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 18:22:14,129][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 18:22:14,132][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 18:22:14,160][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 18:22:14,651][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 18:22:15,719][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 18:22:19,505][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 18:22:22,429][__main__][INFO] - Instantiating callbacks...
[2025-01-11 18:22:22,429][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 18:22:22,431][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 18:22:22,431][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 18:22:22,432][__main__][INFO] - Instantiating loggers...
[2025-01-11 18:22:22,432][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 18:22:22,434][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 18:22:22,537][__main__][INFO] - Logging hyperparameters!
[2025-01-11 18:22:22,541][__main__][INFO] - Starting training!
[2025-01-11 18:22:24,598][__main__][INFO] - Starting testing!
[2025-01-11 18:22:24,599][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 18:22:26,968][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 346, in forward
    fps = self.get_video_fps(video_name)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 210, in get_video_fps
    return fps
           ^^^
UnboundLocalError: cannot access local variable 'fps' where it is not associated with a value
[2025-01-11 18:22:26,975][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_18-22-14
[2025-01-11 18:22:26,975][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 18:30:51,718][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 18:30:51,721][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 18:30:51,748][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 18:30:52,192][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 18:30:53,243][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 18:30:56,196][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 18:30:58,525][__main__][INFO] - Instantiating callbacks...
[2025-01-11 18:30:58,526][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 18:30:58,528][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 18:30:58,529][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 18:30:58,529][__main__][INFO] - Instantiating loggers...
[2025-01-11 18:30:58,529][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 18:30:58,531][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 18:30:58,663][__main__][INFO] - Logging hyperparameters!
[2025-01-11 18:30:58,669][__main__][INFO] - Starting training!
[2025-01-11 18:31:01,048][__main__][INFO] - Starting testing!
[2025-01-11 18:31:01,048][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 18:31:06,804][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 481, in forward
    with open(f"./data/Thumos14/captions/{video_name}.txt", "r", encoding='utf-8') as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './data/Thumos14/captions/video_validation_0000365.txt'
[2025-01-11 18:31:06,811][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_18-30-51
[2025-01-11 18:31:06,811][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 18:32:30,380][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 18:32:30,382][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 18:32:30,407][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 18:32:30,641][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 18:32:31,482][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 18:32:34,825][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 18:32:38,101][__main__][INFO] - Instantiating callbacks...
[2025-01-11 18:32:38,102][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 18:32:38,105][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 18:32:38,106][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 18:32:38,106][__main__][INFO] - Instantiating loggers...
[2025-01-11 18:32:38,106][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 18:32:38,110][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 18:32:38,229][__main__][INFO] - Logging hyperparameters!
[2025-01-11 18:32:38,234][__main__][INFO] - Starting training!
[2025-01-11 18:32:40,675][__main__][INFO] - Starting testing!
[2025-01-11 18:32:40,676][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 18:49:43,309][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 151, in run
    return self.on_run_end()
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 291, in on_run_end
    self._on_evaluation_epoch_end()
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 371, in _on_evaluation_epoch_end
    call._call_lightning_module_hook(trainer, hook_name)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 171, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 126, in on_test_epoch_end
    aps, tious = evaluate(self.dataset, self.predictions, self.split, self.setting, self.video_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/evaluate.py", line 148, in evaluate
    video_dir = video_path + "Thumos14/videos/"
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'str'
[2025-01-11 18:49:43,313][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_18-32-30
[2025-01-11 18:49:43,313][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 21:05:24,227][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 21:05:24,229][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 21:05:24,255][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 21:05:24,734][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 21:05:25,736][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 21:05:29,547][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 21:05:33,042][__main__][INFO] - Instantiating callbacks...
[2025-01-11 21:05:33,043][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 21:05:33,045][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 21:05:33,045][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 21:05:33,045][__main__][INFO] - Instantiating loggers...
[2025-01-11 21:05:33,045][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 21:05:33,047][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 21:05:33,159][__main__][INFO] - Logging hyperparameters!
[2025-01-11 21:05:33,163][__main__][INFO] - Starting training!
[2025-01-11 21:05:35,027][__main__][INFO] - Starting testing!
[2025-01-11 21:05:35,028][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 21:18:47,150][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 151, in run
    return self.on_run_end()
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 291, in on_run_end
    self._on_evaluation_epoch_end()
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 371, in _on_evaluation_epoch_end
    call._call_lightning_module_hook(trainer, hook_name)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 171, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 126, in on_test_epoch_end
    aps, tious = evaluate(self.dataset, self.predictions, self.split, self.setting, self.video_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/evaluate.py", line 148, in evaluate
    video_dir = video_path + "Thumos14/videos/"
                ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for +: 'NoneType' and 'str'
[2025-01-11 21:18:47,153][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_21-05-24
[2025-01-11 21:18:47,154][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 21:26:14,195][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 21:26:14,197][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 21:26:14,223][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 21:26:14,594][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 21:26:15,583][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 21:26:19,104][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 21:26:22,810][__main__][INFO] - Instantiating callbacks...
[2025-01-11 21:26:22,811][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 21:26:22,814][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 21:26:22,815][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 21:26:22,815][__main__][INFO] - Instantiating loggers...
[2025-01-11 21:26:22,816][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 21:26:22,818][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 21:26:22,925][__main__][INFO] - Logging hyperparameters!
[2025-01-11 21:26:22,930][__main__][INFO] - Starting training!
[2025-01-11 21:26:25,100][__main__][INFO] - Starting testing!
[2025-01-11 21:26:25,101][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 21:42:49,875][__main__][INFO] - Best ckpt path: None
[2025-01-11 21:42:49,876][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_21-26-14
[2025-01-11 21:42:49,876][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 21:42:49,877][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-11 23:13:54,752][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:13:54,755][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:13:54,784][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:13:55,315][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:13:56,410][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:13:59,941][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:14:03,951][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:14:03,952][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:14:03,955][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:14:03,956][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:14:03,956][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:14:03,956][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:14:03,959][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:14:04,108][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:14:04,114][__main__][INFO] - Starting training!
[2025-01-11 23:14:03,902][__main__][INFO] - Starting testing!
[2025-01-11 23:14:03,902][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:14:06,834][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 357, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 148, in infer_pseudo_labels
    combined_scores = torch.cat(combined_scores)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: torch.cat(): expected a non-empty list of Tensors
[2025-01-11 23:14:06,840][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-13-54
[2025-01-11 23:14:06,840][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:18:34,713][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:18:34,716][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:18:34,740][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:18:34,968][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:18:35,763][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:18:39,038][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:18:43,039][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:18:43,040][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:18:43,042][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:18:43,042][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:18:43,042][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:18:43,043][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:18:43,044][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:18:43,144][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:18:43,148][__main__][INFO] - Starting training!
[2025-01-11 23:18:44,919][__main__][INFO] - Starting testing!
[2025-01-11 23:18:44,920][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:18:47,391][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 378, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 145, in infer_pseudo_labels
    raise ValueError("avg_features is empty. Ensure class-specific features are loaded correctly.")
ValueError: avg_features is empty. Ensure class-specific features are loaded correctly.
[2025-01-11 23:18:47,394][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-18-34
[2025-01-11 23:18:47,394][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:20:07,655][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:20:07,657][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:20:07,679][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:20:07,901][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:20:08,688][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:20:12,465][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:20:14,949][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:20:14,950][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:20:14,952][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:20:14,952][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:20:14,953][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:20:14,953][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:20:14,955][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:20:15,058][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:20:15,063][__main__][INFO] - Starting training!
[2025-01-11 23:20:17,095][__main__][INFO] - Starting testing!
[2025-01-11 23:20:17,095][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:20:19,565][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 379, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 146, in infer_pseudo_labels
    raise ValueError("avg_features is empty. Ensure class-specific features are loaded correctly.")
ValueError: avg_features is empty. Ensure class-specific features are loaded correctly.
[2025-01-11 23:20:19,569][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-20-07
[2025-01-11 23:20:19,569][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:22:21,429][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:22:21,431][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:22:21,453][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:22:21,670][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:22:22,469][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:22:26,008][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:22:28,318][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:22:28,318][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:22:28,320][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:22:28,320][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:22:28,320][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:22:28,320][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:22:28,322][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:22:28,416][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:22:28,419][__main__][INFO] - Starting training!
[2025-01-11 23:22:30,178][__main__][INFO] - Starting testing!
[2025-01-11 23:22:30,178][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:22:30,023][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 381, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 148, in infer_pseudo_labels
    raise ValueError("avg_features is empty. Ensure class-specific features are loaded correctly.")
ValueError: avg_features is empty. Ensure class-specific features are loaded correctly.
[2025-01-11 23:22:30,026][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-22-21
[2025-01-11 23:22:30,026][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:24:40,085][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:24:40,087][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:24:40,110][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:24:40,328][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:24:41,133][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:24:44,962][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:24:47,059][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:24:47,060][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:24:47,062][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:24:47,062][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:24:47,062][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:24:47,063][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:24:47,064][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:24:47,165][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:24:47,169][__main__][INFO] - Starting training!
[2025-01-11 23:24:49,076][__main__][INFO] - Starting testing!
[2025-01-11 23:24:49,076][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:24:51,634][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 382, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 149, in infer_pseudo_labels
    raise ValueError("avg_features is empty. Ensure class-specific features are loaded correctly.")
ValueError: avg_features is empty. Ensure class-specific features are loaded correctly.
[2025-01-11 23:24:51,638][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-24-40
[2025-01-11 23:24:51,638][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:27:41,400][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:27:41,403][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:27:41,425][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:27:41,648][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:27:42,453][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:27:46,056][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:27:48,199][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:27:48,199][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:27:48,201][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:27:48,201][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:27:48,201][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:27:48,201][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:27:48,203][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:27:48,296][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:27:48,300][__main__][INFO] - Starting training!
[2025-01-11 23:27:50,010][__main__][INFO] - Starting testing!
[2025-01-11 23:27:50,010][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:27:52,223][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 382, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 149, in infer_pseudo_labels
    raise ValueError("avg_features is empty. Ensure class-specific features are loaded correctly.")
ValueError: avg_features is empty. Ensure class-specific features are loaded correctly.
[2025-01-11 23:27:52,227][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-27-41
[2025-01-11 23:27:52,227][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:34:26,656][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:34:26,658][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:34:26,681][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:34:26,896][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:34:27,700][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:34:31,476][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:34:33,554][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:34:33,554][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:34:33,556][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:34:33,556][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:34:33,557][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:34:33,557][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:34:33,559][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:34:33,657][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:34:33,661][__main__][INFO] - Starting training!
[2025-01-11 23:34:35,491][__main__][INFO] - Starting testing!
[2025-01-11 23:34:35,491][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:34:37,625][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 381, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 148, in infer_pseudo_labels
    raise ValueError("avg_features is empty. Ensure class-specific features are loaded correctly.")
ValueError: avg_features is empty. Ensure class-specific features are loaded correctly.
[2025-01-11 23:34:37,628][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-34-26
[2025-01-11 23:34:37,628][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:35:10,983][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:35:10,985][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:35:11,008][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:35:11,229][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:35:12,028][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:35:15,823][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:35:17,807][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:35:17,808][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:35:17,809][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:35:17,810][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:35:17,810][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:35:17,810][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:35:17,812][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:35:17,906][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:35:17,909][__main__][INFO] - Starting training!
[2025-01-11 23:35:19,639][__main__][INFO] - Starting testing!
[2025-01-11 23:35:19,640][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:35:19,165][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 382, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 149, in infer_pseudo_labels
    raise ValueError("avg_features is empty. Ensure class-specific features are loaded correctly.")
ValueError: avg_features is empty. Ensure class-specific features are loaded correctly.
[2025-01-11 23:35:19,168][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-35-10
[2025-01-11 23:35:19,169][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:36:41,446][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:36:41,448][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:36:41,472][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:36:41,692][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:36:42,481][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:36:46,293][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:36:48,279][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:36:48,280][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:36:48,281][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:36:48,282][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:36:48,282][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:36:48,282][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:36:48,284][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:36:48,377][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:36:48,381][__main__][INFO] - Starting training!
[2025-01-11 23:36:50,126][__main__][INFO] - Starting testing!
[2025-01-11 23:36:50,127][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:36:49,807][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 381, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 157, in infer_pseudo_labels
    combined_feature = torch.cat([image_features_avg.unsqueeze(0), avg_feature.unsqueeze(0)])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument tensors in method wrapper_CUDA_cat)
[2025-01-11 23:36:49,811][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-36-41
[2025-01-11 23:36:49,812][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:39:27,237][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:39:27,239][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:39:27,263][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:39:27,486][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:39:28,298][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:39:32,231][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:39:34,216][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:39:34,216][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:39:34,218][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:39:34,218][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:39:34,219][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:39:34,219][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:39:34,221][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:39:34,314][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:39:34,317][__main__][INFO] - Starting training!
[2025-01-11 23:39:36,081][__main__][INFO] - Starting testing!
[2025-01-11 23:39:36,082][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:39:38,477][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 384, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 160, in infer_pseudo_labels
    combined_feature = torch.cat([image_features_avg.unsqueeze(0), avg_feature.unsqueeze(0)])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Tensors must have same number of dimensions: got 2 and 3
[2025-01-11 23:39:38,481][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-39-27
[2025-01-11 23:39:38,481][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:41:45,506][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:41:45,508][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:41:45,530][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:41:45,746][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:41:43,921][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:41:47,746][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:41:49,759][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:41:49,760][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:41:49,761][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:41:49,761][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:41:49,762][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:41:49,762][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:41:49,764][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:41:49,856][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:41:49,859][__main__][INFO] - Starting training!
[2025-01-11 23:41:51,651][__main__][INFO] - Starting testing!
[2025-01-11 23:41:51,651][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:41:53,767][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 387, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 163, in infer_pseudo_labels
    combined_feature = torch.cat([image_features_avg.unsqueeze(0), avg_feature.unsqueeze(0)])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Tensors must have same number of dimensions: got 2 and 3
[2025-01-11 23:41:53,770][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-41-45
[2025-01-11 23:41:53,770][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:43:36,272][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:43:36,275][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:43:36,298][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:43:36,519][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:43:37,314][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:43:40,982][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:43:43,087][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:43:43,087][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:43:43,089][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:43:43,090][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:43:43,090][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:43:43,090][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:43:43,093][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:43:43,198][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:43:43,203][__main__][INFO] - Starting training!
[2025-01-11 23:43:42,734][__main__][INFO] - Starting testing!
[2025-01-11 23:43:42,735][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:43:57,145][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-43-36
[2025-01-11 23:43:57,146][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:44:43,883][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-11 23:44:43,886][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-11 23:44:43,909][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-11 23:44:44,130][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-11 23:44:44,926][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-11 23:44:48,630][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-11 23:44:50,663][__main__][INFO] - Instantiating callbacks...
[2025-01-11 23:44:50,664][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-11 23:44:50,665][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-11 23:44:50,666][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-11 23:44:50,666][__main__][INFO] - Instantiating loggers...
[2025-01-11 23:44:50,666][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-11 23:44:50,668][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-11 23:44:50,761][__main__][INFO] - Logging hyperparameters!
[2025-01-11 23:44:50,765][__main__][INFO] - Starting training!
[2025-01-11 23:44:52,491][__main__][INFO] - Starting testing!
[2025-01-11 23:44:52,491][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-11 23:58:13,058][__main__][INFO] - Best ckpt path: None
[2025-01-11 23:58:13,059][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-11_23-44-43
[2025-01-11 23:58:13,059][src.utils.utils][INFO] - Closing wandb!
[2025-01-11 23:58:13,060][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-12 00:00:45,933][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 00:00:45,935][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 00:00:45,960][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 00:00:46,254][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 00:00:47,061][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 00:00:50,843][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 00:00:54,283][__main__][INFO] - Instantiating callbacks...
[2025-01-12 00:00:54,283][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 00:00:54,285][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 00:00:54,286][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 00:00:54,286][__main__][INFO] - Instantiating loggers...
[2025-01-12 00:00:54,286][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 00:00:54,289][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 00:00:54,378][__main__][INFO] - Logging hyperparameters!
[2025-01-12 00:00:54,382][__main__][INFO] - Starting training!
[2025-01-12 00:00:56,459][__main__][INFO] - Starting testing!
[2025-01-12 00:00:56,466][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 00:00:56,674][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 387, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 177, in infer_pseudo_labels
    combined_scores = torch.cat(combined_scores)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: zero-dimensional tensor (at position 0) cannot be concatenated
[2025-01-12 00:00:56,690][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_00-00-45
[2025-01-12 00:00:56,690][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 00:03:16,953][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 00:03:16,956][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 00:03:16,978][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 00:03:17,218][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 00:03:18,010][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 00:03:21,739][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 00:03:24,563][__main__][INFO] - Instantiating callbacks...
[2025-01-12 00:03:24,563][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 00:03:24,565][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 00:03:24,565][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 00:03:24,565][__main__][INFO] - Instantiating loggers...
[2025-01-12 00:03:24,565][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 00:03:24,567][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 00:03:24,659][__main__][INFO] - Logging hyperparameters!
[2025-01-12 00:03:24,662][__main__][INFO] - Starting training!
[2025-01-12 00:03:26,331][__main__][INFO] - Starting testing!
[2025-01-12 00:03:26,331][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 00:03:25,819][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 388, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 178, in infer_pseudo_labels
    scores = torch.cat(scores)
             ^^^^^^^^^^^^^^^^^
RuntimeError: zero-dimensional tensor (at position 0) cannot be concatenated
[2025-01-12 00:03:25,822][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_00-03-16
[2025-01-12 00:03:25,822][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 00:05:43,906][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 00:05:43,909][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 00:05:43,930][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 00:05:44,147][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 00:05:44,927][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 00:05:48,269][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 00:05:50,185][__main__][INFO] - Instantiating callbacks...
[2025-01-12 00:05:50,186][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 00:05:50,187][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 00:05:50,187][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 00:05:50,188][__main__][INFO] - Instantiating loggers...
[2025-01-12 00:05:50,188][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 00:05:50,190][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 00:05:50,284][__main__][INFO] - Logging hyperparameters!
[2025-01-12 00:05:50,288][__main__][INFO] - Starting training!
[2025-01-12 00:05:51,998][__main__][INFO] - Starting testing!
[2025-01-12 00:05:51,998][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 00:05:52,977][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 392, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 182, in infer_pseudo_labels
    scores = torch.cat(scores)
             ^^^^^^^^^^^^^^^^^
RuntimeError: zero-dimensional tensor (at position 0) cannot be concatenated
[2025-01-12 00:05:52,980][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_00-05-43
[2025-01-12 00:05:52,980][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 00:07:09,110][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 00:07:09,112][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 00:07:09,135][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 00:07:09,353][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 00:07:10,131][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 00:07:13,869][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 00:07:15,749][__main__][INFO] - Instantiating callbacks...
[2025-01-12 00:07:15,750][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 00:07:15,751][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 00:07:15,751][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 00:07:15,752][__main__][INFO] - Instantiating loggers...
[2025-01-12 00:07:15,752][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 00:07:15,754][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 00:07:15,847][__main__][INFO] - Logging hyperparameters!
[2025-01-12 00:07:15,851][__main__][INFO] - Starting training!
[2025-01-12 00:07:17,519][__main__][INFO] - Starting testing!
[2025-01-12 00:07:17,520][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 00:07:21,065][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 392, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 185, in infer_pseudo_labels
    return index[0][0], scores
           ~~~~~~~~^^^
IndexError: invalid index of a 0-dim tensor. Use `tensor.item()` in Python or `tensor.item<T>()` in C++ to convert a 0-dim tensor to a number
[2025-01-12 00:07:21,068][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_00-07-09
[2025-01-12 00:07:21,068][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 00:08:00,109][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 00:08:00,111][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 00:08:00,133][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 00:08:00,345][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 00:08:01,114][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 00:08:04,658][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 00:08:06,493][__main__][INFO] - Instantiating callbacks...
[2025-01-12 00:08:06,494][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 00:08:06,495][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 00:08:06,495][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 00:08:06,496][__main__][INFO] - Instantiating loggers...
[2025-01-12 00:08:06,496][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 00:08:06,498][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 00:08:06,589][__main__][INFO] - Logging hyperparameters!
[2025-01-12 00:08:06,593][__main__][INFO] - Starting training!
[2025-01-12 00:08:08,271][__main__][INFO] - Starting testing!
[2025-01-12 00:08:08,271][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 00:08:10,437][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 390, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 183, in infer_pseudo_labels
    return index[0][0], scores
           ~~~~~~~~^^^
IndexError: invalid index of a 0-dim tensor. Use `tensor.item()` in Python or `tensor.item<T>()` in C++ to convert a 0-dim tensor to a number
[2025-01-12 00:08:10,440][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_00-08-00
[2025-01-12 00:08:10,440][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:35:26,642][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:35:26,644][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:35:26,668][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:35:27,104][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:35:28,018][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:35:31,110][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:35:34,084][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:35:34,085][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:35:34,086][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:35:34,087][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:35:34,087][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:35:34,087][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:35:34,089][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:35:34,205][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:35:34,209][__main__][INFO] - Starting training!
[2025-01-12 17:35:36,049][__main__][INFO] - Starting testing!
[2025-01-12 17:35:36,050][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:35:38,564][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 390, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 183, in infer_pseudo_labels
    return index[0][0], scores
           ~~~~~~~~^^^
IndexError: invalid index of a 0-dim tensor. Use `tensor.item()` in Python or `tensor.item<T>()` in C++ to convert a 0-dim tensor to a number
[2025-01-12 17:35:38,567][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-35-26
[2025-01-12 17:35:38,567][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:35:56,451][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:35:56,453][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:35:56,472][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:35:56,649][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:35:57,305][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:36:00,929][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:36:03,761][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:36:03,762][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:36:03,764][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:36:03,764][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:36:03,764][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:36:03,765][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:36:03,767][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:36:03,852][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:36:03,856][__main__][INFO] - Starting training!
[2025-01-12 17:36:05,500][__main__][INFO] - Starting testing!
[2025-01-12 17:36:05,500][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:36:07,713][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 390, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 180, in infer_pseudo_labels
    scores = torch.cat(scores)
             ^^^^^^^^^^^^^^^^^
RuntimeError: zero-dimensional tensor (at position 0) cannot be concatenated
[2025-01-12 17:36:07,716][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-35-56
[2025-01-12 17:36:07,716][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:37:29,430][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:37:29,432][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:37:29,458][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:37:29,904][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:37:30,061][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:37:33,178][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:37:36,153][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:37:36,153][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:37:36,155][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:37:36,155][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:37:36,155][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:37:36,155][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:37:36,157][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:37:36,250][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:37:36,254][__main__][INFO] - Starting training!
[2025-01-12 17:37:37,866][__main__][INFO] - Starting testing!
[2025-01-12 17:37:37,867][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:37:40,289][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 391, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 181, in infer_pseudo_labels
    scores = torch.cat(scores)
             ^^^^^^^^^^^^^^^^^
RuntimeError: zero-dimensional tensor (at position 0) cannot be concatenated
[2025-01-12 17:37:40,302][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-37-29
[2025-01-12 17:37:40,303][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:39:09,416][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:39:09,418][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:39:09,439][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:39:09,634][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:39:10,389][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:39:13,671][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:39:15,777][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:39:15,777][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:39:15,779][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:39:15,779][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:39:15,779][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:39:15,779][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:39:15,781][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:39:15,867][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:39:15,871][__main__][INFO] - Starting training!
[2025-01-12 17:39:17,494][__main__][INFO] - Starting testing!
[2025-01-12 17:39:17,495][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:39:19,786][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 391, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 182, in infer_pseudo_labels
    _, index = torch.topk(scores, self.topk)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
[2025-01-12 17:39:19,790][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-39-09
[2025-01-12 17:39:19,790][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:40:08,591][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:40:08,593][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:40:08,615][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:40:08,825][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:40:09,571][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:40:12,592][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:40:15,522][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:40:15,523][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:40:15,524][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:40:15,524][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:40:15,524][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:40:15,525][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:40:15,526][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:40:15,613][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:40:15,616][__main__][INFO] - Starting training!
[2025-01-12 17:40:17,208][__main__][INFO] - Starting testing!
[2025-01-12 17:40:17,208][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:40:20,236][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 391, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 182, in infer_pseudo_labels
    _, index = torch.topk(scores, self.topk)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
[2025-01-12 17:40:20,239][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-40-08
[2025-01-12 17:40:20,239][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:41:08,426][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:41:08,428][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:41:08,450][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:41:08,660][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:41:09,379][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:41:12,050][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:41:14,421][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:41:14,421][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:41:14,423][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:41:14,423][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:41:14,423][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:41:14,423][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:41:14,425][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:41:14,513][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:41:14,517][__main__][INFO] - Starting training!
[2025-01-12 17:41:16,080][__main__][INFO] - Starting testing!
[2025-01-12 17:41:16,081][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:41:18,208][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 391, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 181, in infer_pseudo_labels
    _, index = torch.topk(scores, self.topk)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
[2025-01-12 17:41:18,211][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-41-08
[2025-01-12 17:41:18,211][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:45:08,405][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:45:08,407][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:45:08,428][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:45:08,627][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:45:09,347][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:45:12,404][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:45:14,259][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:45:14,259][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:45:14,260][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:45:14,261][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:45:14,261][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:45:14,261][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:45:14,263][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:45:14,349][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:45:14,352][__main__][INFO] - Starting training!
[2025-01-12 17:45:15,952][__main__][INFO] - Starting testing!
[2025-01-12 17:45:15,952][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:45:18,638][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 389, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 179, in infer_pseudo_labels
    _, index = torch.topk(scores, self.topk)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
[2025-01-12 17:45:18,642][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-45-08
[2025-01-12 17:45:18,642][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:46:55,500][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:46:55,502][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:46:55,522][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:46:55,721][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:46:56,432][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:46:58,943][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:47:00,942][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:47:00,943][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:47:00,954][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:47:00,954][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:47:00,955][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:47:00,955][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:47:00,957][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:47:01,044][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:47:01,048][__main__][INFO] - Starting training!
[2025-01-12 17:47:02,644][__main__][INFO] - Starting testing!
[2025-01-12 17:47:02,645][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:47:05,261][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 392, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 179, in infer_pseudo_labels
    _, index = torch.topk(scores, self.topk)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
[2025-01-12 17:47:05,264][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-46-55
[2025-01-12 17:47:05,264][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:47:49,827][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:47:49,829][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:47:49,850][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:47:50,047][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:47:50,774][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:47:53,985][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:47:55,873][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:47:55,873][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:47:55,874][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:47:55,875][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:47:55,875][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:47:55,875][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:47:55,877][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:47:55,964][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:47:55,967][__main__][INFO] - Starting training!
[2025-01-12 17:47:57,638][__main__][INFO] - Starting testing!
[2025-01-12 17:47:57,639][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:47:59,715][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 392, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 179, in infer_pseudo_labels
    _, index = torch.topk(scores, self.topk)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
[2025-01-12 17:47:59,718][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-47-49
[2025-01-12 17:47:59,718][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:48:41,058][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:48:41,060][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:48:41,081][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:48:41,283][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:48:41,996][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:48:45,070][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:48:46,875][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:48:46,876][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:48:46,877][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:48:46,877][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:48:46,878][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:48:46,878][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:48:46,880][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:48:46,966][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:48:46,969][__main__][INFO] - Starting training!
[2025-01-12 17:48:48,535][__main__][INFO] - Starting testing!
[2025-01-12 17:48:48,535][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:48:51,245][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 392, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 178, in infer_pseudo_labels
    scores = torch.cat(scores)
             ^^^^^^^^^^^^^^^^^
RuntimeError: zero-dimensional tensor (at position 0) cannot be concatenated
[2025-01-12 17:48:51,248][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-48-41
[2025-01-12 17:48:51,248][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:51:53,326][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:51:53,328][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:51:53,350][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:51:53,554][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:51:54,297][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:51:57,785][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:51:59,628][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:51:59,629][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:51:59,630][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:51:59,631][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:51:59,631][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:51:59,631][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:51:59,633][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:51:59,722][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:51:59,726][__main__][INFO] - Starting training!
[2025-01-12 17:52:01,495][__main__][INFO] - Starting testing!
[2025-01-12 17:52:01,496][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:52:03,711][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 391, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 177, in infer_pseudo_labels
    scores = torch.cat(scores)
             ^^^^^^^^^^^^^^^^^
RuntimeError: zero-dimensional tensor (at position 0) cannot be concatenated
[2025-01-12 17:52:03,713][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-51-53
[2025-01-12 17:52:03,714][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:52:50,710][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:52:50,712][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:52:50,735][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:52:50,947][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:52:51,701][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:52:54,968][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:52:56,921][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:52:56,921][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:52:56,923][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:52:56,923][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:52:56,923][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:52:56,923][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:52:56,925][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:52:57,016][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:52:57,020][__main__][INFO] - Starting training!
[2025-01-12 17:52:58,625][__main__][INFO] - Starting testing!
[2025-01-12 17:52:58,626][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:53:00,866][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 395, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 184, in infer_pseudo_labels
    return index[0][0], scores
           ~~~~~~~~^^^
IndexError: invalid index of a 0-dim tensor. Use `tensor.item()` in Python or `tensor.item<T>()` in C++ to convert a 0-dim tensor to a number
[2025-01-12 17:53:00,868][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-52-50
[2025-01-12 17:53:00,869][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:54:28,499][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:54:28,501][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:54:28,523][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:54:28,729][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:54:29,485][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:54:32,606][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:54:34,395][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:54:34,395][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:54:34,397][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:54:34,397][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:54:34,397][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:54:34,397][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:54:34,399][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:54:34,489][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:54:34,492][__main__][INFO] - Starting training!
[2025-01-12 17:54:36,142][__main__][INFO] - Starting testing!
[2025-01-12 17:54:36,142][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:54:38,297][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 395, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 184, in infer_pseudo_labels
    return index[0][0].item(), scores
           ~~~~~~~~^^^
IndexError: invalid index of a 0-dim tensor. Use `tensor.item()` in Python or `tensor.item<T>()` in C++ to convert a 0-dim tensor to a number
[2025-01-12 17:54:38,300][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-54-28
[2025-01-12 17:54:38,300][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:54:48,508][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:54:48,510][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:54:48,535][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:54:48,762][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:54:49,538][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:54:52,749][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:54:55,006][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:54:55,006][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:54:55,008][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:54:55,008][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:54:55,008][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:54:55,009][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:54:55,011][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:54:55,102][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:54:55,106][__main__][INFO] - Starting training!
[2025-01-12 17:54:56,722][__main__][INFO] - Starting testing!
[2025-01-12 17:54:56,723][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:54:58,893][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 395, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 184, in infer_pseudo_labels
    return index.item(), scores
           ^^^^^^^^^^^^
RuntimeError: a Tensor with 3 elements cannot be converted to Scalar
[2025-01-12 17:54:58,896][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-54-48
[2025-01-12 17:54:58,896][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:55:15,214][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:55:15,216][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:55:15,239][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:55:15,467][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:55:16,328][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:55:18,937][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:55:21,410][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:55:21,410][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:55:21,411][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:55:21,412][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:55:21,412][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:55:21,412][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:55:21,414][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:55:21,505][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:55:21,509][__main__][INFO] - Starting training!
[2025-01-12 17:55:23,289][__main__][INFO] - Starting testing!
[2025-01-12 17:55:23,290][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:55:25,720][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 395, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 184, in infer_pseudo_labels
    return index.item(), scores
           ^^^^^^^^^^^^
RuntimeError: a Tensor with 3 elements cannot be converted to Scalar
[2025-01-12 17:55:25,723][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-55-15
[2025-01-12 17:55:25,723][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:56:17,435][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:56:17,437][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:56:17,458][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:56:17,664][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:56:18,403][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:56:20,509][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:56:22,224][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:56:22,224][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:56:22,226][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:56:22,226][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:56:22,226][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:56:22,227][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:56:22,228][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:56:22,317][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:56:22,320][__main__][INFO] - Starting training!
[2025-01-12 17:56:23,927][__main__][INFO] - Starting testing!
[2025-01-12 17:56:23,928][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:56:25,982][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 397, in forward
    class_label = self.inverted_cls[indexes.item()]
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
KeyError: 13
[2025-01-12 17:56:25,985][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-56-17
[2025-01-12 17:56:25,985][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:57:03,052][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:57:03,054][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:57:03,077][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:57:03,302][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:57:04,104][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:57:07,241][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:57:09,873][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:57:09,874][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:57:09,875][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:57:09,876][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:57:09,876][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:57:09,876][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:57:09,878][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:57:09,966][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:57:09,969][__main__][INFO] - Starting training!
[2025-01-12 17:57:11,695][__main__][INFO] - Starting testing!
[2025-01-12 17:57:11,695][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:57:13,718][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 397, in forward
    class_label = self.inverted_cls[indexes.item()]
                                    ^^^^^^^^^^^^
AttributeError: 'int' object has no attribute 'item'
[2025-01-12 17:57:13,721][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-57-03
[2025-01-12 17:57:13,721][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:57:32,514][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:57:32,517][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:57:32,539][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:57:32,749][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:57:33,498][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:57:36,803][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:57:38,608][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:57:38,609][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:57:38,610][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:57:38,610][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:57:38,611][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:57:38,611][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:57:38,613][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:57:38,701][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:57:38,704][__main__][INFO] - Starting training!
[2025-01-12 17:57:40,313][__main__][INFO] - Starting testing!
[2025-01-12 17:57:40,314][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:57:42,356][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 397, in forward
    class_label = self.inverted_cls[indexes.item()]
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
KeyError: 13
[2025-01-12 17:57:42,358][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-57-32
[2025-01-12 17:57:42,359][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 17:59:18,868][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 17:59:18,870][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 17:59:18,892][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 17:59:19,100][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 17:59:19,855][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 17:59:22,933][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 17:59:24,694][__main__][INFO] - Instantiating callbacks...
[2025-01-12 17:59:24,694][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 17:59:24,695][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 17:59:24,695][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 17:59:24,696][__main__][INFO] - Instantiating loggers...
[2025-01-12 17:59:24,696][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 17:59:24,698][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 17:59:24,771][__main__][INFO] - Logging hyperparameters!
[2025-01-12 17:59:24,774][__main__][INFO] - Starting training!
[2025-01-12 17:59:26,422][__main__][INFO] - Starting testing!
[2025-01-12 17:59:26,422][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 17:59:27,613][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 398, in forward
    class_label = self.inverted_cls[indexes.item()]
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
KeyError: 13
[2025-01-12 17:59:27,616][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_17-59-18
[2025-01-12 17:59:27,616][src.utils.utils][INFO] - Closing wandb!
[2025-01-12 18:05:08,235][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-12 18:05:08,237][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-12 18:05:08,258][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-12 18:05:08,464][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-12 18:05:09,212][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-12 18:05:11,249][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-12 18:05:13,120][__main__][INFO] - Instantiating callbacks...
[2025-01-12 18:05:13,120][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-12 18:05:13,121][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-12 18:05:13,122][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-12 18:05:13,122][__main__][INFO] - Instantiating loggers...
[2025-01-12 18:05:13,122][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-12 18:05:13,124][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-12 18:05:13,212][__main__][INFO] - Logging hyperparameters!
[2025-01-12 18:05:13,215][__main__][INFO] - Starting training!
[2025-01-12 18:05:14,895][__main__][INFO] - Starting testing!
[2025-01-12 18:05:14,896][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-12 18:05:17,079][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 401, in forward
    class_label = self.inverted_cls[indexes.item()]
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
KeyError: 13
[2025-01-12 18:05:17,082][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-12_18-05-08
[2025-01-12 18:05:17,082][src.utils.utils][INFO] - Closing wandb!
[2025-01-13 14:46:11,470][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-13 14:46:11,473][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-13 14:46:11,499][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-13 14:46:11,958][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-13 14:46:12,885][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-13 14:46:16,481][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-13 14:46:19,332][__main__][INFO] - Instantiating callbacks...
[2025-01-13 14:46:19,332][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-13 14:46:19,334][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-13 14:46:19,334][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-13 14:46:19,334][__main__][INFO] - Instantiating loggers...
[2025-01-13 14:46:19,335][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-13 14:46:19,337][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-13 14:46:19,441][__main__][INFO] - Logging hyperparameters!
[2025-01-13 14:46:19,444][__main__][INFO] - Starting training!
[2025-01-13 14:46:21,221][__main__][INFO] - Starting testing!
[2025-01-13 14:46:21,222][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-13 14:46:23,803][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 401, in forward
    class_label = self.inverted_cls[indexes.item()]
                  ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
KeyError: 13
[2025-01-13 14:46:23,806][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-13_14-46-11
[2025-01-13 14:46:23,806][src.utils.utils][INFO] - Closing wandb!
[2025-01-13 15:45:35,079][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-13 15:45:35,081][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-13 15:45:35,106][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-13 15:45:35,546][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-13 15:45:36,509][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-13 15:45:39,653][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-13 15:45:43,158][__main__][INFO] - Instantiating callbacks...
[2025-01-13 15:45:43,158][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-13 15:45:43,159][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-13 15:45:43,160][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-13 15:45:43,160][__main__][INFO] - Instantiating loggers...
[2025-01-13 15:45:43,160][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-13 15:45:43,162][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-13 15:45:43,265][__main__][INFO] - Logging hyperparameters!
[2025-01-13 15:45:43,269][__main__][INFO] - Starting training!
[2025-01-13 15:45:44,892][__main__][INFO] - Starting testing!
[2025-01-13 15:45:44,893][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-13 15:45:57,843][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-13_15-45-35
[2025-01-13 15:45:57,843][src.utils.utils][INFO] - Closing wandb!
[2025-01-13 15:47:10,753][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-13 15:47:10,755][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-13 15:47:10,779][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-13 15:47:11,214][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-13 15:47:12,146][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-13 15:47:15,492][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-13 15:47:18,622][__main__][INFO] - Instantiating callbacks...
[2025-01-13 15:47:18,623][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-13 15:47:18,626][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-13 15:47:18,626][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-13 15:47:18,627][__main__][INFO] - Instantiating loggers...
[2025-01-13 15:47:18,627][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-13 15:47:18,630][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-13 15:47:18,737][__main__][INFO] - Logging hyperparameters!
[2025-01-13 15:47:18,742][__main__][INFO] - Starting training!
[2025-01-13 15:47:20,913][__main__][INFO] - Starting testing!
[2025-01-13 15:47:20,914][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-13 16:01:38,106][__main__][INFO] - Best ckpt path: None
[2025-01-13 16:01:38,107][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-13_15-47-10
[2025-01-13 16:01:38,107][src.utils.utils][INFO] - Closing wandb!
[2025-01-13 16:01:38,107][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 18:04:50,250][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:04:50,252][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:04:50,279][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:04:50,759][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:04:51,777][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:04:55,270][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:04:58,592][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:04:58,593][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:04:58,595][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:04:58,595][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:04:58,595][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:04:58,596][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:04:58,598][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:04:58,730][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:04:58,734][__main__][INFO] - Starting training!
[2025-01-14 18:05:00,983][__main__][INFO] - Starting testing!
[2025-01-14 18:05:00,984][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:05:06,889][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-04-50
[2025-01-14 18:05:06,889][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:08:20,369][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:08:20,371][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:08:20,398][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:08:20,858][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:08:21,840][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:08:25,112][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:08:28,603][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:08:28,603][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:08:28,605][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:08:28,605][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:08:28,606][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:08:28,606][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:08:28,608][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:08:28,737][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:08:28,741][__main__][INFO] - Starting training!
[2025-01-14 18:08:30,938][__main__][INFO] - Starting testing!
[2025-01-14 18:08:30,938][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:08:37,322][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-08-20
[2025-01-14 18:08:37,322][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:10:14,241][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:10:14,243][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:10:14,265][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:10:14,474][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:10:15,234][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:10:18,394][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:10:20,660][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 113, in __init__
    self.avg_features = self.load_avg_features(self.avg_features_path)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 146, in load_avg_features
    print(f"avg_features shape: {avg_features.shape}")
                                 ^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'shape'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
AttributeError("'dict' object has no attribute 'shape'")
full_key: model.net
[2025-01-14 18:10:20,672][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-10-14
[2025-01-14 18:10:20,672][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:11:46,042][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:11:46,044][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:11:46,067][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:11:46,302][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:11:47,112][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:11:50,465][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:11:52,081][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 113, in __init__
    self.avg_features = self.load_avg_features(self.avg_features_path)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 147, in load_avg_features
    avg_features = torch.stack(list(avg_features.values()))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: stack expects each tensor to be equal size, but got [110, 768] at entry 0 and [402, 768] at entry 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
RuntimeError('stack expects each tensor to be equal size, but got [110, 768] at entry 0 and [402, 768] at entry 1')
full_key: model.net
[2025-01-14 18:11:52,084][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-11-46
[2025-01-14 18:11:52,084][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:14:18,580][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:14:18,582][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:14:18,605][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:14:18,834][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:14:19,632][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:14:23,263][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:14:26,386][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 113, in __init__
    self.avg_features = self.load_avg_features(self.avg_features_path)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 147, in load_avg_features
    print(f"avg_features type: {type(avg_features_)}")
                                     ^^^^^^^^^^^^^
NameError: name 'avg_features_' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
NameError("name 'avg_features_' is not defined")
full_key: model.net
[2025-01-14 18:14:26,387][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-14-18
[2025-01-14 18:14:26,387][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:15:00,950][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:15:00,952][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:15:00,974][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:15:01,191][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:15:01,992][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:15:05,691][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:15:08,509][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 113, in __init__
    self.avg_features = self.load_avg_features(self.avg_features_path)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 148, in load_avg_features
    avg_features = torch.stack(list(avg_features.values()))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: stack expects each tensor to be equal size, but got [110, 768] at entry 0 and [402, 768] at entry 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
RuntimeError('stack expects each tensor to be equal size, but got [110, 768] at entry 0 and [402, 768] at entry 1')
full_key: model.net
[2025-01-14 18:15:08,511][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-15-00
[2025-01-14 18:15:08,511][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:16:06,584][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:16:06,586][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:16:06,608][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:16:06,821][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:16:07,591][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:16:11,309][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:16:13,800][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 113, in __init__
    self.avg_features = self.load_avg_features(self.avg_features_path)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 148, in load_avg_features
    avg_features_tensor = torch.stack(list(avg_features.values()))
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: stack expects each tensor to be equal size, but got [110, 768] at entry 0 and [402, 768] at entry 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
RuntimeError('stack expects each tensor to be equal size, but got [110, 768] at entry 0 and [402, 768] at entry 1')
full_key: model.net
[2025-01-14 18:16:13,803][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-16-06
[2025-01-14 18:16:13,803][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:17:32,908][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:17:32,911][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:17:32,933][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:17:33,147][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:17:33,920][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:17:37,097][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:17:40,014][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:17:40,015][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:17:40,017][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:17:40,017][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:17:40,018][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:17:40,018][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:17:40,020][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:17:40,139][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:17:40,144][__main__][INFO] - Starting training!
[2025-01-14 18:17:46,016][__main__][INFO] - Starting testing!
[2025-01-14 18:17:46,017][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:17:49,288][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 389, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 167, in infer_pseudo_labels
    if self.avg_features_tensor is None or self.avg_features_tensor.numel() == 0:
       ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1931, in __getattr__
    raise AttributeError(
AttributeError: 'T3ALNet' object has no attribute 'avg_features_tensor'
[2025-01-14 18:17:49,301][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-17-32
[2025-01-14 18:17:49,301][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:20:16,003][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:20:16,006][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:20:16,030][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:20:16,253][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:20:17,026][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:20:20,304][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:20:23,643][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 113, in __init__
    self.avg_features = self.load_avg_features(self.avg_features_path)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 148, in load_avg_features
    avg_features_tensor = torch.stack(list(avg_features.values()))
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: stack expects each tensor to be equal size, but got [110, 768] at entry 0 and [402, 768] at entry 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
RuntimeError('stack expects each tensor to be equal size, but got [110, 768] at entry 0 and [402, 768] at entry 1')
full_key: model.net
[2025-01-14 18:20:23,646][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-20-15
[2025-01-14 18:20:23,646][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:21:55,480][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:21:55,482][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:21:55,505][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:21:55,737][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:21:56,522][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:21:59,750][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:22:02,002][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:22:02,002][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:22:02,004][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:22:02,005][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:22:02,005][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:22:02,005][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:22:02,007][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:22:02,106][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:22:02,110][__main__][INFO] - Starting training!
[2025-01-14 18:22:04,407][__main__][INFO] - Starting testing!
[2025-01-14 18:22:04,407][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:22:06,640][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 415, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 170, in infer_pseudo_labels
    if not self.avg_features:
RuntimeError: Boolean value of Tensor with more than one value is ambiguous
[2025-01-14 18:22:06,643][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-21-55
[2025-01-14 18:22:06,643][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:27:19,375][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:27:19,377][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:27:19,399][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:27:19,623][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:27:20,417][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:27:23,778][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:27:26,149][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:27:26,149][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:27:26,153][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:27:26,154][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:27:26,154][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:27:26,154][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:27:26,157][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:27:26,268][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:27:26,272][__main__][INFO] - Starting training!
[2025-01-14 18:27:28,276][__main__][INFO] - Starting testing!
[2025-01-14 18:27:28,276][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:27:30,759][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 412, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 167, in infer_pseudo_labels
    if not self.avg_features:
RuntimeError: Boolean value of Tensor with more than one value is ambiguous
[2025-01-14 18:27:30,764][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-27-19
[2025-01-14 18:27:30,764][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:28:32,078][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:28:32,081][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:28:32,103][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:28:32,315][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:28:33,064][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:28:36,170][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:28:38,213][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:28:38,213][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:28:38,215][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:28:38,215][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:28:38,215][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:28:38,216][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:28:38,217][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:28:38,312][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:28:38,315][__main__][INFO] - Starting training!
[2025-01-14 18:28:40,384][__main__][INFO] - Starting testing!
[2025-01-14 18:28:40,384][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:28:42,848][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 396, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1931, in __getattr__
    raise AttributeError(
AttributeError: 'T3ALNet' object has no attribute 'infer_pseudo_labels'
[2025-01-14 18:28:42,852][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-28-32
[2025-01-14 18:28:42,852][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:33:31,263][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:33:31,267][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:33:31,300][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:33:31,773][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:33:32,805][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:33:36,109][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:33:39,280][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:33:39,281][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:33:39,283][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:33:39,283][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:33:39,284][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:33:39,284][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:33:39,286][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:33:39,392][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:33:39,398][__main__][INFO] - Starting training!
[2025-01-14 18:33:41,330][__main__][INFO] - Starting testing!
[2025-01-14 18:33:41,331][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:33:43,925][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 409, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 172, in infer_pseudo_labels
    for class_name, avg_feature in self.avg_features.items():
                                   ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'items'
[2025-01-14 18:33:43,931][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-33-31
[2025-01-14 18:33:43,931][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:35:25,305][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:35:25,307][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:35:25,332][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:35:25,557][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:35:26,342][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:35:28,447][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:35:31,245][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:35:31,245][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:35:31,247][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:35:31,248][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:35:31,248][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:35:31,248][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:35:31,250][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:35:31,356][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:35:31,360][__main__][INFO] - Starting training!
[2025-01-14 18:35:33,415][__main__][INFO] - Starting testing!
[2025-01-14 18:35:33,415][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:35:35,610][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 409, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 184, in infer_pseudo_labels
    _, scores_avg = self.compute_score(image_features_avg, avg_feature)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 220, in compute_score
    scores = (x @ y.T)
              ~~^~~~~
RuntimeError: both arguments to matmul need to be at least 1D, but they are 1D and 0D
[2025-01-14 18:35:35,613][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-35-25
[2025-01-14 18:35:35,614][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:37:01,540][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:37:01,543][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:37:01,567][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:37:01,800][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:37:02,597][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:37:05,935][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:37:09,228][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:37:09,228][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:37:09,230][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:37:09,230][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:37:09,230][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:37:09,230][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:37:09,233][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:37:09,332][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:37:09,335][__main__][INFO] - Starting training!
[2025-01-14 18:37:11,016][__main__][INFO] - Starting testing!
[2025-01-14 18:37:11,016][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:37:13,077][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 411, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 186, in infer_pseudo_labels
    _, scores_avg = self.compute_score(image_features_avg, avg_feature)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 222, in compute_score
    scores = (x @ y.T)
              ~~^~~~~
RuntimeError: both arguments to matmul need to be at least 1D, but they are 1D and 0D
[2025-01-14 18:37:13,080][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-37-01
[2025-01-14 18:37:13,080][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:37:51,859][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:37:51,861][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:37:51,884][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:37:52,100][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:37:52,882][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:37:56,522][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:37:58,818][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:37:58,818][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:37:58,820][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:37:58,820][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:37:58,820][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:37:58,820][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:37:58,822][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:37:58,915][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:37:58,918][__main__][INFO] - Starting training!
[2025-01-14 18:38:00,699][__main__][INFO] - Starting testing!
[2025-01-14 18:38:00,700][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:38:15,309][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-37-51
[2025-01-14 18:38:15,310][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:39:36,723][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 18:39:36,725][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 18:39:36,748][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 18:39:36,978][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 18:39:37,770][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 18:39:41,308][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 18:39:45,378][__main__][INFO] - Instantiating callbacks...
[2025-01-14 18:39:45,378][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 18:39:45,380][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 18:39:45,381][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 18:39:45,381][__main__][INFO] - Instantiating loggers...
[2025-01-14 18:39:45,381][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 18:39:45,383][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 18:39:45,485][__main__][INFO] - Logging hyperparameters!
[2025-01-14 18:39:45,488][__main__][INFO] - Starting training!
[2025-01-14 18:39:47,546][__main__][INFO] - Starting testing!
[2025-01-14 18:39:47,547][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 18:53:58,140][__main__][INFO] - Best ckpt path: None
[2025-01-14 18:53:58,140][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_18-39-36
[2025-01-14 18:53:58,140][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 18:53:58,141][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 19:33:57,116][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 19:33:57,119][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 19:33:57,145][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 19:33:57,603][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 19:33:58,573][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 19:34:02,226][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 19:34:05,881][__main__][INFO] - Instantiating callbacks...
[2025-01-14 19:34:05,881][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 19:34:05,883][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 19:34:05,884][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 19:34:05,884][__main__][INFO] - Instantiating loggers...
[2025-01-14 19:34:05,884][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 19:34:05,886][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 19:34:05,994][__main__][INFO] - Logging hyperparameters!
[2025-01-14 19:34:05,998][__main__][INFO] - Starting training!
[2025-01-14 19:34:08,312][__main__][INFO] - Starting testing!
[2025-01-14 19:34:08,312][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 19:48:37,917][__main__][INFO] - Best ckpt path: None
[2025-01-14 19:48:37,917][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_19-33-57
[2025-01-14 19:48:37,918][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 19:48:37,918][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 20:06:30,421][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 20:06:30,423][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 20:06:30,449][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 20:06:30,907][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 20:06:31,885][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 20:06:35,084][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 20:06:38,272][__main__][INFO] - Instantiating callbacks...
[2025-01-14 20:06:38,273][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 20:06:38,275][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 20:06:38,276][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 20:06:38,276][__main__][INFO] - Instantiating loggers...
[2025-01-14 20:06:38,276][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 20:06:38,279][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 20:06:38,411][__main__][INFO] - Logging hyperparameters!
[2025-01-14 20:06:38,416][__main__][INFO] - Starting training!
[2025-01-14 20:06:40,189][__main__][INFO] - Starting testing!
[2025-01-14 20:06:40,190][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 20:21:27,323][__main__][INFO] - Best ckpt path: None
[2025-01-14 20:21:27,323][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_20-06-30
[2025-01-14 20:21:27,323][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 20:21:27,324][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 20:23:58,699][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 20:23:58,701][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 20:23:58,731][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 20:23:59,056][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 20:23:59,958][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 20:24:03,085][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 20:24:05,927][__main__][INFO] - Instantiating callbacks...
[2025-01-14 20:24:05,927][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 20:24:05,930][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 20:24:05,931][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 20:24:05,931][__main__][INFO] - Instantiating loggers...
[2025-01-14 20:24:05,931][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 20:24:05,933][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 20:24:06,022][__main__][INFO] - Logging hyperparameters!
[2025-01-14 20:24:06,026][__main__][INFO] - Starting training!
[2025-01-14 20:24:08,152][__main__][INFO] - Starting testing!
[2025-01-14 20:24:08,153][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 20:34:38,078][__main__][INFO] - Best ckpt path: None
[2025-01-14 20:34:38,080][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_20-23-58
[2025-01-14 20:34:38,080][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 20:34:38,080][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 20:35:47,411][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 20:35:47,413][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 20:35:47,437][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 20:35:47,729][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 20:35:48,580][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 20:35:52,139][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 20:35:54,995][__main__][INFO] - Instantiating callbacks...
[2025-01-14 20:35:54,996][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 20:35:54,998][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 20:35:54,998][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 20:35:54,998][__main__][INFO] - Instantiating loggers...
[2025-01-14 20:35:54,999][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 20:35:55,001][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 20:35:55,097][__main__][INFO] - Logging hyperparameters!
[2025-01-14 20:35:55,102][__main__][INFO] - Starting training!
[2025-01-14 20:35:56,976][__main__][INFO] - Starting testing!
[2025-01-14 20:35:56,976][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 20:49:52,194][__main__][INFO] - Best ckpt path: None
[2025-01-14 20:49:52,195][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_20-35-47
[2025-01-14 20:49:52,195][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 20:49:52,195][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 20:59:07,889][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 20:59:07,891][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 20:59:07,916][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 20:59:08,207][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 20:59:09,050][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 20:59:12,827][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 20:59:16,799][__main__][INFO] - Instantiating callbacks...
[2025-01-14 20:59:16,799][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 20:59:16,801][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 20:59:16,801][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 20:59:16,801][__main__][INFO] - Instantiating loggers...
[2025-01-14 20:59:16,802][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 20:59:16,803][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 20:59:16,881][__main__][INFO] - Logging hyperparameters!
[2025-01-14 20:59:16,885][__main__][INFO] - Starting training!
[2025-01-14 20:59:18,734][__main__][INFO] - Starting testing!
[2025-01-14 20:59:18,734][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 20:59:23,648][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_20-59-07
[2025-01-14 20:59:23,648][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:01:14,736][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:01:14,738][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:01:14,760][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:01:14,973][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:01:15,748][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:01:19,384][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:01:21,301][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:01:21,301][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:01:21,303][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:01:21,303][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:01:21,303][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:01:21,303][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:01:21,305][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:01:21,407][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:01:21,411][__main__][INFO] - Starting training!
[2025-01-14 21:01:21,806][__main__][INFO] - Starting testing!
[2025-01-14 21:01:21,807][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:01:25,776][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-01-14
[2025-01-14 21:01:25,776][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:03:37,783][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:03:37,786][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:03:37,807][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:03:38,030][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:03:38,795][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:03:41,992][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:03:44,220][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:03:44,220][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:03:44,222][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:03:44,222][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:03:44,222][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:03:44,223][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:03:44,224][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:03:44,330][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:03:44,333][__main__][INFO] - Starting training!
[2025-01-14 21:03:46,180][__main__][INFO] - Starting testing!
[2025-01-14 21:03:46,181][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:03:51,604][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-03-37
[2025-01-14 21:03:51,604][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:04:00,169][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:04:00,172][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:04:00,193][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:04:00,408][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:04:01,261][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:04:04,421][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:04:06,499][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:04:06,500][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:04:06,502][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:04:06,502][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:04:06,502][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:04:06,502][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:04:06,504][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:04:06,594][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:04:06,597][__main__][INFO] - Starting training!
[2025-01-14 21:04:08,491][__main__][INFO] - Starting testing!
[2025-01-14 21:04:08,492][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:04:19,580][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-04-00
[2025-01-14 21:04:19,580][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:05:36,494][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:05:36,496][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:05:36,520][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:05:36,741][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:05:37,516][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:05:41,136][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:05:43,102][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:05:43,102][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:05:43,104][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:05:43,104][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:05:43,104][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:05:43,105][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:05:43,106][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:05:43,205][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:05:43,210][__main__][INFO] - Starting training!
[2025-01-14 21:05:44,934][__main__][INFO] - Starting testing!
[2025-01-14 21:05:44,934][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:05:50,183][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-05-36
[2025-01-14 21:05:50,184][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:08:32,537][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:08:32,540][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:08:32,562][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:08:32,778][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:08:33,579][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:08:35,741][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:08:37,778][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:08:37,778][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:08:37,780][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:08:37,781][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:08:37,781][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:08:37,781][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:08:37,783][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:08:37,884][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:08:37,888][__main__][INFO] - Starting training!
[2025-01-14 21:08:39,649][__main__][INFO] - Starting testing!
[2025-01-14 21:08:39,649][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:09:18,770][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-08-32
[2025-01-14 21:09:18,770][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:10:33,716][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:10:33,719][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:10:33,743][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:10:33,955][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:10:34,728][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:10:37,514][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:10:39,383][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:10:39,383][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:10:39,385][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:10:39,385][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:10:39,385][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:10:39,386][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:10:39,387][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:10:39,489][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:10:39,492][__main__][INFO] - Starting training!
[2025-01-14 21:10:41,253][__main__][INFO] - Starting testing!
[2025-01-14 21:10:41,254][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:10:46,334][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-10-33
[2025-01-14 21:10:46,334][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:12:29,292][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:12:29,295][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:12:29,318][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:12:29,536][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:12:30,307][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:12:33,486][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:12:35,447][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:12:35,447][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:12:35,449][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:12:35,449][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:12:35,449][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:12:35,450][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:12:35,451][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:12:35,543][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:12:35,547][__main__][INFO] - Starting training!
[2025-01-14 21:12:37,302][__main__][INFO] - Starting testing!
[2025-01-14 21:12:37,302][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:12:41,028][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 443, in forward
    similarity = self.model.logit_scale.exp() * tta_emb @ features.T
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2025-01-14 21:12:41,033][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-12-29
[2025-01-14 21:12:41,033][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:13:30,531][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:13:30,533][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:13:30,555][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:13:30,751][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:13:31,538][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:13:35,066][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:13:37,002][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:13:37,002][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:13:37,004][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:13:37,005][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:13:37,005][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:13:37,005][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:13:37,007][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:13:37,103][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:13:37,108][__main__][INFO] - Starting training!
[2025-01-14 21:13:38,867][__main__][INFO] - Starting testing!
[2025-01-14 21:13:38,868][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:13:41,078][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 414, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 176, in infer_pseudo_labels
    _, scores_avg = self.compute_score(image_features_avg, avg_feature)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 215, in compute_score
    self.model.logit_scale = torch.nn.Parameter(torch.tensor([1.0])).to(x.device)
    ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1959, in __setattr__
    raise TypeError(
TypeError: cannot assign 'torch.cuda.FloatTensor' as parameter 'logit_scale' (torch.nn.Parameter or None expected)
[2025-01-14 21:13:41,081][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-13-30
[2025-01-14 21:13:41,082][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:13:51,648][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:13:51,650][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:13:51,679][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:13:51,926][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:13:52,732][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:13:56,058][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:13:58,523][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:13:58,523][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:13:58,524][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:13:58,525][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:13:58,525][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:13:58,525][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:13:58,527][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:13:58,602][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:13:58,605][__main__][INFO] - Starting training!
[2025-01-14 21:14:00,226][__main__][INFO] - Starting testing!
[2025-01-14 21:14:00,227][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:14:02,840][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 447, in forward
    similarity = self.model.logit_scale.exp() * tta_emb @ features.T
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2025-01-14 21:14:02,843][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-13-51
[2025-01-14 21:14:02,843][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:15:14,577][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:15:14,579][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:15:14,603][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:15:14,808][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:15:15,586][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:15:19,236][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:15:21,067][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:15:21,068][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:15:21,069][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:15:21,069][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:15:21,070][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:15:21,070][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:15:21,071][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:15:21,162][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:15:21,165][__main__][INFO] - Starting training!
[2025-01-14 21:15:22,827][__main__][INFO] - Starting testing!
[2025-01-14 21:15:22,828][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:15:25,383][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 447, in forward
    similarity = self.model.logit_scale.exp() * tta_emb @ features.T
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2025-01-14 21:15:25,387][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-15-14
[2025-01-14 21:15:25,387][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:15:57,207][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:15:57,210][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:15:57,232][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:15:57,448][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:15:58,243][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:16:01,926][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:16:03,903][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:16:03,903][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:16:03,905][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:16:03,905][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:16:03,906][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:16:03,906][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:16:03,908][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:16:03,999][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:16:04,002][__main__][INFO] - Starting training!
[2025-01-14 21:16:05,768][__main__][INFO] - Starting testing!
[2025-01-14 21:16:05,769][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:16:08,353][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 447, in forward
    similarity = self.model.logit_scale.exp() * tta_emb @ features.T
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2025-01-14 21:16:08,356][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-15-57
[2025-01-14 21:16:08,356][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:16:38,854][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:16:38,856][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:16:38,879][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:16:39,103][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:16:39,881][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:16:43,389][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:16:45,218][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:16:45,219][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:16:45,221][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:16:45,221][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:16:45,221][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:16:45,221][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:16:45,223][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:16:45,323][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:16:45,327][__main__][INFO] - Starting training!
[2025-01-14 21:16:45,499][__main__][INFO] - Starting testing!
[2025-01-14 21:16:45,500][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:16:48,068][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 447, in forward
    similarity = self.model.logit_scale.exp() * tta_emb @ features.T
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2025-01-14 21:16:48,072][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-16-38
[2025-01-14 21:16:48,072][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:17:33,250][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:17:33,252][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:17:33,278][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:17:33,491][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:17:34,288][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:17:38,525][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:17:40,396][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:17:40,396][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:17:40,398][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:17:40,398][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:17:40,399][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:17:40,399][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:17:40,400][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:17:40,491][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:17:40,494][__main__][INFO] - Starting training!
[2025-01-14 21:17:42,119][__main__][INFO] - Starting testing!
[2025-01-14 21:17:42,120][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:17:44,589][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 447, in forward
    similarity = self.model.logit_scale.exp() * tta_emb @ features.T
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2025-01-14 21:17:44,592][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-17-33
[2025-01-14 21:17:44,592][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:18:51,975][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:18:51,977][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:18:52,000][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:18:52,213][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:18:52,990][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:18:56,484][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:18:58,336][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:18:58,336][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:18:58,338][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:18:58,338][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:18:58,338][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:18:58,338][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:18:58,340][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:18:58,431][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:18:58,435][__main__][INFO] - Starting training!
[2025-01-14 21:19:00,145][__main__][INFO] - Starting testing!
[2025-01-14 21:19:00,146][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:19:02,476][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 447, in forward
    similarity = self.model.logit_scale.exp() * tta_emb @ features.T
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2025-01-14 21:19:02,479][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-18-51
[2025-01-14 21:19:02,480][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:21:02,092][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:21:02,094][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:21:02,117][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:21:02,329][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:21:03,104][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:21:06,702][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:21:08,536][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:21:08,537][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:21:08,538][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:21:08,539][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:21:08,539][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:21:08,539][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:21:08,541][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:21:08,630][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:21:08,633][__main__][INFO] - Starting training!
[2025-01-14 21:21:10,355][__main__][INFO] - Starting testing!
[2025-01-14 21:21:10,355][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:21:14,888][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 452, in forward
    similarity = self.model.logit_scale.exp() * tta_emb @ features.T
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2025-01-14 21:21:14,891][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-21-02
[2025-01-14 21:21:14,891][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:22:26,918][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:22:26,920][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:22:26,942][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:22:27,160][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:22:27,930][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:22:31,364][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:22:33,269][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:22:33,269][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:22:33,271][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:22:33,272][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:22:33,272][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:22:33,272][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:22:33,274][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:22:33,369][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:22:33,373][__main__][INFO] - Starting training!
[2025-01-14 21:22:35,098][__main__][INFO] - Starting testing!
[2025-01-14 21:22:35,099][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:22:37,713][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 450, in forward
    similarity = self.model.logit_scale.exp() * tta_emb @ features.T
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
[2025-01-14 21:22:37,717][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-22-26
[2025-01-14 21:22:37,717][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:25:25,106][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:25:25,109][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:25:25,132][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:25:25,341][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:25:26,110][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:25:28,004][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:25:30,036][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:25:30,036][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:25:30,038][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:25:30,038][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:25:30,038][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:25:30,039][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:25:30,040][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:25:30,131][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:25:30,135][__main__][INFO] - Starting training!
[2025-01-14 21:25:31,885][__main__][INFO] - Starting testing!
[2025-01-14 21:25:31,885][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:25:44,698][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-25-25
[2025-01-14 21:25:44,698][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:25:57,621][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:25:57,623][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:25:57,645][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:25:57,872][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:25:56,979][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:26:01,112][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:26:03,603][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:26:03,604][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:26:03,605][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:26:03,606][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:26:03,606][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:26:03,606][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:26:03,608][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:26:03,701][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:26:03,704][__main__][INFO] - Starting training!
[2025-01-14 21:26:05,521][__main__][INFO] - Starting testing!
[2025-01-14 21:26:05,522][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:26:25,035][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-25-57
[2025-01-14 21:26:25,035][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:26:28,684][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:26:28,687][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:26:28,709][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:26:28,926][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:26:28,164][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:26:31,493][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:26:33,293][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:26:33,294][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:26:33,295][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:26:33,295][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:26:33,296][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:26:33,296][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:26:33,297][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:26:33,391][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:26:33,394][__main__][INFO] - Starting training!
[2025-01-14 21:26:35,153][__main__][INFO] - Starting testing!
[2025-01-14 21:26:35,153][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:40:47,603][__main__][INFO] - Best ckpt path: None
[2025-01-14 21:40:47,604][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-26-28
[2025-01-14 21:40:47,604][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:40:47,604][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 21:42:48,404][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 21:42:48,406][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 21:42:48,427][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 21:42:48,696][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 21:42:49,436][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 21:42:50,967][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 21:42:52,978][__main__][INFO] - Instantiating callbacks...
[2025-01-14 21:42:52,978][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 21:42:52,980][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 21:42:52,981][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 21:42:52,981][__main__][INFO] - Instantiating loggers...
[2025-01-14 21:42:52,981][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 21:42:52,983][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 21:42:53,082][__main__][INFO] - Logging hyperparameters!
[2025-01-14 21:42:53,088][__main__][INFO] - Starting training!
[2025-01-14 21:42:55,040][__main__][INFO] - Starting testing!
[2025-01-14 21:42:55,040][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 21:53:15,814][__main__][INFO] - Best ckpt path: None
[2025-01-14 21:53:15,815][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_21-42-48
[2025-01-14 21:53:15,815][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 21:53:15,815][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 22:01:32,209][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 22:01:32,212][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 22:01:32,237][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 22:01:32,570][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 22:01:33,507][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 22:01:37,151][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 22:01:39,911][__main__][INFO] - Instantiating callbacks...
[2025-01-14 22:01:39,912][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 22:01:39,913][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 22:01:39,914][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 22:01:39,914][__main__][INFO] - Instantiating loggers...
[2025-01-14 22:01:39,914][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 22:01:39,915][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 22:01:40,010][__main__][INFO] - Logging hyperparameters!
[2025-01-14 22:01:40,013][__main__][INFO] - Starting training!
[2025-01-14 22:01:41,743][__main__][INFO] - Starting testing!
[2025-01-14 22:01:41,744][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 22:01:44,408][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 103, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 749, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 789, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 982, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1019, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 144, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 433, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 323, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/lightning/pytorch/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 105, in test_step
    self.model_step(
  File "/home/def/fewshot/src/models/tt_method_module.py", line 83, in model_step
    return self.forward(batch, opt)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/tt_method_module.py", line 77, in forward
    return self.net(x, opt)
           ^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 423, in forward
    indexes, _ = self.infer_pseudo_labels(image_features)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 176, in infer_pseudo_labels
    _, scores_avg = self.compute_score(image_features_avg, avg_feature)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 229, in compute_score
    smoothed_probs = probabilities * (1 - smoothing_factor) + (smoothing_factor / probabilities.size(-1))
                                                                                  ^^^^^^^^^^^^^^^^^^^^^^
IndexError: Dimension specified as -1 but tensor has no dimensions
[2025-01-14 22:01:44,414][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_22-01-32
[2025-01-14 22:01:44,414][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 22:03:25,039][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 22:03:25,042][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 22:03:25,068][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 22:03:25,554][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 22:03:26,617][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 22:03:28,644][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 22:03:31,822][__main__][INFO] - Instantiating callbacks...
[2025-01-14 22:03:31,822][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 22:03:31,824][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 22:03:31,825][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 22:03:31,825][__main__][INFO] - Instantiating loggers...
[2025-01-14 22:03:31,825][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 22:03:31,827][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 22:03:31,953][__main__][INFO] - Logging hyperparameters!
[2025-01-14 22:03:31,957][__main__][INFO] - Starting training!
[2025-01-14 22:03:34,010][__main__][INFO] - Starting testing!
[2025-01-14 22:03:34,010][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 22:03:38,814][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_22-03-25
[2025-01-14 22:03:38,815][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 22:06:41,352][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 22:06:41,355][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 22:06:41,381][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 22:06:41,859][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 22:06:42,881][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 22:06:46,650][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 22:06:49,793][__main__][INFO] - Instantiating callbacks...
[2025-01-14 22:06:49,793][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 22:06:49,795][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 22:06:49,795][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 22:06:49,795][__main__][INFO] - Instantiating loggers...
[2025-01-14 22:06:49,796][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 22:06:49,797][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 22:06:49,898][__main__][INFO] - Logging hyperparameters!
[2025-01-14 22:06:49,902][__main__][INFO] - Starting training!
[2025-01-14 22:06:51,744][__main__][INFO] - Starting testing!
[2025-01-14 22:06:51,744][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 22:07:02,638][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_22-06-41
[2025-01-14 22:07:02,638][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 22:08:25,021][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 22:08:25,023][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 22:08:25,045][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 22:08:25,266][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 22:08:26,048][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 22:08:29,512][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 22:08:31,424][__main__][INFO] - Instantiating callbacks...
[2025-01-14 22:08:31,424][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 22:08:31,426][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 22:08:31,426][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 22:08:31,426][__main__][INFO] - Instantiating loggers...
[2025-01-14 22:08:31,426][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 22:08:31,428][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 22:08:31,520][__main__][INFO] - Logging hyperparameters!
[2025-01-14 22:08:31,524][__main__][INFO] - Starting training!
[2025-01-14 22:08:33,317][__main__][INFO] - Starting testing!
[2025-01-14 22:08:33,317][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 22:08:33,447][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_22-08-24
[2025-01-14 22:08:33,448][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 22:09:08,465][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 22:09:08,467][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 22:09:08,489][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 22:09:08,708][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 22:09:09,478][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 22:09:12,931][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 22:09:14,851][__main__][INFO] - Instantiating callbacks...
[2025-01-14 22:09:14,852][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 22:09:14,853][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 22:09:14,853][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 22:09:14,854][__main__][INFO] - Instantiating loggers...
[2025-01-14 22:09:14,854][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 22:09:14,855][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 22:09:14,948][__main__][INFO] - Logging hyperparameters!
[2025-01-14 22:09:14,951][__main__][INFO] - Starting training!
[2025-01-14 22:09:16,618][__main__][INFO] - Starting testing!
[2025-01-14 22:09:16,619][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 22:09:18,112][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_22-09-08
[2025-01-14 22:09:18,112][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 22:10:24,568][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 22:10:24,571][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 22:10:24,595][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 22:10:24,815][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 22:10:25,603][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 22:10:28,808][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 22:10:30,590][__main__][INFO] - Instantiating callbacks...
[2025-01-14 22:10:30,591][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 22:10:30,592][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 22:10:30,593][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 22:10:30,593][__main__][INFO] - Instantiating loggers...
[2025-01-14 22:10:30,593][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 22:10:30,595][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 22:10:30,687][__main__][INFO] - Logging hyperparameters!
[2025-01-14 22:10:30,691][__main__][INFO] - Starting training!
[2025-01-14 22:10:32,428][__main__][INFO] - Starting testing!
[2025-01-14 22:10:32,429][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 22:24:47,441][__main__][INFO] - Best ckpt path: None
[2025-01-14 22:24:47,442][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_22-10-24
[2025-01-14 22:24:47,442][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 22:24:47,442][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 22:37:57,632][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 22:37:57,635][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 22:37:57,661][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 22:37:58,281][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 22:37:59,343][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 22:38:02,304][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 22:38:05,469][__main__][INFO] - Instantiating callbacks...
[2025-01-14 22:38:05,470][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 22:38:05,472][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 22:38:05,472][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 22:38:05,472][__main__][INFO] - Instantiating loggers...
[2025-01-14 22:38:05,472][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 22:38:05,474][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 22:38:05,579][__main__][INFO] - Logging hyperparameters!
[2025-01-14 22:38:05,583][__main__][INFO] - Starting training!
[2025-01-14 22:38:07,270][__main__][INFO] - Starting testing!
[2025-01-14 22:38:07,271][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 22:52:14,977][__main__][INFO] - Best ckpt path: None
[2025-01-14 22:52:14,978][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_22-37-57
[2025-01-14 22:52:14,978][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 22:52:14,978][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 23:03:27,222][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 23:03:27,225][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 23:03:27,252][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 23:03:27,696][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 23:03:28,522][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 23:03:31,816][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 23:03:33,942][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 111, in __init__
    self.avg_features = self.load_avg_features(self.avg_features_path)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/models/components/tt_method.py", line 145, in load_avg_features
    avg_features_tensor = torch.stack([feature.mean(dim=0) for feature in avg_features.values()])
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: stack expects each tensor to be equal size, but got [22, 768] at entry 0 and [81, 768] at entry 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/def/fewshot/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
                               ^^^^^^^^^^^^^^^^^^
  File "/home/def/fewshot/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
           ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 342, in instantiate_node
    value = instantiate_node(
            ^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/def/miniforge3/envs/fewshot/lib/python3.11/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.models.components.tt_method.T3ALNet':
RuntimeError('stack expects each tensor to be equal size, but got [22, 768] at entry 0 and [81, 768] at entry 1')
full_key: model.net
[2025-01-14 23:03:33,946][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_23-03-27
[2025-01-14 23:03:33,946][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 23:07:25,901][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 23:07:25,904][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 23:07:25,927][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 23:07:26,293][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 23:07:27,109][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 23:07:28,507][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 23:07:30,695][__main__][INFO] - Instantiating callbacks...
[2025-01-14 23:07:30,696][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 23:07:30,698][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 23:07:30,698][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 23:07:30,699][__main__][INFO] - Instantiating loggers...
[2025-01-14 23:07:30,699][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 23:07:30,700][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 23:07:30,793][__main__][INFO] - Logging hyperparameters!
[2025-01-14 23:07:30,797][__main__][INFO] - Starting training!
[2025-01-14 23:07:32,473][__main__][INFO] - Starting testing!
[2025-01-14 23:07:32,473][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 23:22:28,253][__main__][INFO] - Best ckpt path: None
[2025-01-14 23:22:28,254][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_23-07-25
[2025-01-14 23:22:28,254][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 23:22:28,255][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 23:31:53,473][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 23:31:53,476][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 23:31:53,500][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 23:31:53,923][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 23:31:54,753][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 23:31:58,336][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 23:32:00,549][__main__][INFO] - Instantiating callbacks...
[2025-01-14 23:32:00,549][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 23:32:00,551][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 23:32:00,552][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 23:32:00,552][__main__][INFO] - Instantiating loggers...
[2025-01-14 23:32:00,552][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 23:32:00,554][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 23:32:00,650][__main__][INFO] - Logging hyperparameters!
[2025-01-14 23:32:00,654][__main__][INFO] - Starting training!
[2025-01-14 23:32:02,210][__main__][INFO] - Starting testing!
[2025-01-14 23:32:02,210][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-14 23:46:00,629][__main__][INFO] - Best ckpt path: None
[2025-01-14 23:46:00,630][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_23-31-53
[2025-01-14 23:46:00,630][src.utils.utils][INFO] - Closing wandb!
[2025-01-14 23:46:00,631][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2025-01-14 23:50:32,277][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2025-01-14 23:50:32,279][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2025-01-14 23:50:32,303][__main__][INFO] - Instantiating datamodule <src.data.custom_datamodule.T3ALDataModule>
[2025-01-14 23:50:32,675][__main__][INFO] - Instantiating model <src.models.tt_method_module.T3ALModule>
[2025-01-14 23:50:33,461][root][INFO] - Loaded coca_ViT-L-14 model config.
[2025-01-14 23:50:34,984][root][INFO] - Loading pretrained coca_ViT-L-14 weights (mscoco_finetuned_laion2B-s13B-b90k).
[2025-01-14 23:50:37,039][__main__][INFO] - Instantiating callbacks...
[2025-01-14 23:50:37,039][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.ModelCheckpoint>
[2025-01-14 23:50:37,041][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichModelSummary>
[2025-01-14 23:50:37,041][src.utils.instantiators][INFO] - Instantiating callback <lightning.pytorch.callbacks.RichProgressBar>
[2025-01-14 23:50:37,041][__main__][INFO] - Instantiating loggers...
[2025-01-14 23:50:37,041][src.utils.instantiators][INFO] - Instantiating logger <lightning.pytorch.loggers.wandb.WandbLogger>
[2025-01-14 23:50:37,043][__main__][INFO] - Instantiating trainer <lightning.pytorch.trainer.Trainer>
[2025-01-14 23:50:37,123][__main__][INFO] - Logging hyperparameters!
[2025-01-14 23:50:37,127][__main__][INFO] - Starting training!
[2025-01-14 23:50:38,575][__main__][INFO] - Starting testing!
[2025-01-14 23:50:38,576][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2025-01-15 00:04:46,640][__main__][INFO] - Best ckpt path: None
[2025-01-15 00:04:46,641][src.utils.utils][INFO] - Output dir: /home/def/fewshot/logs/train/runs/2025-01-14_23-50-32
[2025-01-15 00:04:46,641][src.utils.utils][INFO] - Closing wandb!
[2025-01-15 00:04:46,641][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
